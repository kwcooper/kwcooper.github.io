<h3 id="ephys-data-analysis">Ephys Data Analysis</h3>
<p>One of the first questions that I had when first starting to analyze ephys data was how do you go from the noisy recording to something meaningful (and of course by meaningful I mean pretty).</p>

<p>In my field, where we study specific oscillatory frequencies, it may be a bit obscure how this is accomplished. I wrote a quick Matlab script to demonstrate one method to parse the data from the raw signal, all the way up to more useful parts, that is the phase of the oscillation, as well as the signals amplitude. You can see the change in the wave in the figure below:</p>

<p><img src="/images/phaseAmpExtraction.jpg" alt="_config.yml" class="center-image" /></p>

<p>The steps are fairly straightforward:</p>

<p>1.Filter the raw signal for your desired frequency. I chose a wide theta band (4-12Hz) because thatâ€™s what I study.</p>

<p>2.Next, take the <a href="http://www.scholarpedia.org/article/Hilbert_transform_for_brain_waves">Hilbert transform</a> of the signal. The Hilbert is similar to the Fourier, but is more commonly used due to some of its beneficial properties for our data type.</p>

<p>3.Next, compute the phase <a href="https://www.mathworks.com/help/matlab/ref/angle.html">angle</a> of the transform, effectively splitting the imaginary and real parts. This gives you the phase of the theta wave from -\pi to \pi</p>

<p>4.Optionaly, take the absolute value of the transform, which will give you the amplitude, (which can be likened to power) of the frequency band</p>

<h3 id="code">Code</h3>
<p>This is the code I used to generate the figure.</p>

<p>(Requires the Matlab signal analysis package)</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="n">thetarange</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="mi">12</span><span class="p">];</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">dataTimeSeries</span><span class="p">;</span> <span class="c1">% should be an array</span>
<span class="n">DSamp</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">);</span> <span class="n">fs</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="nb">figure</span><span class="p">;</span> <span class="nb">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="nb">plot</span><span class="p">(</span><span class="n">DSamp</span><span class="p">);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Original Data (1000 dp/ 2s)'</span><span class="p">);</span>

<span class="n">filtSig</span> <span class="o">=</span> <span class="n">buttfilt</span><span class="p">(</span><span class="n">DSamp</span><span class="p">,</span><span class="n">thetarange</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="s1">'bandpass'</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="nb">plot</span><span class="p">(</span><span class="n">filtSig</span><span class="p">);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Filtered Data 4-12Hz'</span><span class="p">);</span>

<span class="c1">% Take the Hilbert Transform of the filtered signal </span>
<span class="n">hilbSig</span> <span class="o">=</span> <span class="n">hilbert</span><span class="p">(</span><span class="n">filtSig</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="nb">plot</span><span class="p">(</span><span class="n">hilbSig</span><span class="p">);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Hilbert Transform'</span><span class="p">);</span>

<span class="c1">% Return the phase angle of the complex array in radians </span>
<span class="n">thetaPhs</span> <span class="o">=</span> <span class="nb">angle</span><span class="p">(</span><span class="n">hilbSig</span><span class="p">)</span><span class="o">'</span><span class="p">;</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span> <span class="nb">plot</span><span class="p">(</span><span class="n">thetaPhs</span><span class="p">);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Theta Phase'</span><span class="p">);</span>

<span class="n">thetaAmp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">hilbSig</span><span class="p">)</span><span class="o">'</span><span class="p">;</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="nb">plot</span><span class="p">(</span><span class="n">thetaAmp</span><span class="p">);</span> <span class="nb">title</span><span class="p">(</span><span class="s1">'Theta Amplitude'</span><span class="p">);</span></code></pre></figure>

